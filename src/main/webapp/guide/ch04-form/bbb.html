<!DOCTYPE html>
<head>
<meta charset="utf-8"/>
<title>自测bbb</title>
<script>
	var file4 = document.getElementById("file4");
	var result = document.getElementById("result");
	if(typeof FileReader == "undefined"){
		result.innerHTML = "浏览器不支持FileReader";
		file4.setAttribute("disabled","disabled");
	}
 	function showFileName(){
		var file;
		for(var i=0; i<document.getElementById("selfile").files.length; i++){
			file = document.getElementById("selfile").files[i];
			alert(file.name);
		}
	}
	function showFileType(){
		var file ;
		file = document.getElementById("file2").files[0];
		document.getElementById("size2").innerHTML = file.size;
		document.getElementById("type2").innerHTML = file.type;		
	}
	function fileUpload(){
		var file;
		for(var i=0; i<document.getElementById("file3").files.length; i++){
			file = document.getElementById("file3").files[i];
			if(!/image\/\w+/.test(file.type)){
				alert(file.name + "不是图像文件！");
				break;
			}else{
				alert(file.name + "文件已上传");
			}
		}
	}
	
	function readAsDataURL(){
		var file = document.getElementById("file4").files[0];
		if(!/image\/\w+/.test(file.type)){
			alert("请选择图像文件");
			return false;
		}
		var rea = new FileReader();
		rea.readAsDataURL(file);
		rea.onload = function(e){
			result = document.getElementById("result");
			result.innerHTML = "<img src='"+this.result+"'/>";
		}
	}
	function readAsBinaryString(){
		var file = document.getElementById("file4").files[0];
		var reader = new FileReader();
		//将文件以二进制形式进行读入页面
		reader.readAsBinaryString(file);
		reader.onload = function(f){
			var result=document.getElementById("result");
			//在页面上显示二进制数据
			result.innerHTML=this.result;
		}
	}
	function readAsText(){
		var file = document.getElementById("file4").files[0];
		var reader = new FileReader();
		//将文件以文本形式进行读入页面
		reader.readAsText(file);
		reader.onload = function(f){
			var result=document.getElementById("result");
			//在页面上显示读入文本
			result.innerHTML=this.result;
		}
	}
	function readFile(){
		var file = document.getElementById("file4").files[0];
		var reader = new FileReader();
		reader.onload = function(e) {
			result.innerHTML = '<img src="'+this.result+'" alt=""/>'
			alert("读取成功");
		}
		reader.onprogress = function(e) {
			alert("读取中");
		}
		reader.onabort = function(e) {
			alert("读取中断");
		}
		reader.onerror = function(e) {
			alert("读取失败");
		}
		reader.onloadstart = function(e) {
			alert("开始读取");
		}
		reader.onloadend = function(e) {
			alert("读取完成");
		}
		reader.readAsDataURL(file);
	}
</script>
</head>

<hr/>
<h4>FileList和fill 测试</h4>
<label for="selfile">选择文件</label>
<input type="file" id="selfile" multiple size="80"/>
<input type="button" onClick="showFileName();" value="文件上传"/>
<p>
<p> 选择文件：
  <input type="file" id="file2" />
  <input type="button" value="显示文件信息" onclick="showFileType();"/>
  <br/>
  文件字节长度:<span id="size2"></span><br/>
  文件类型：<span id="type2"></span>
<p>
<p> 选择文件：
  <input type="file" id="file3" multiple/>
  <input type="button" value="文件上传" onclick="fileUpload();"/>
<hr/>
<h4>FileReader 测试</h4>
<p>
  <label>请选择一个文件：</label>
  <input type="file" id="file4" />
  <input type="button" value="读取图像" onclick="readAsDataURL()"/>
  <input type="button" value="读取二进制数据" onclick="readAsBinaryString()"/>
  <input type="button" value="读取文本文件" onclick="readAsText()"/>
  <input type="button" value="显示图像-测试事件" onclick="readFile()" />
</p>
<div name="result" id="result"> 
  <!-- 这里用来显示读取结果 --> 
</div>
