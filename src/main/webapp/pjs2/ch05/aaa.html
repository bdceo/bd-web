<!DOCTYPE html>
<head>
<meta charset="utf-8" />
<title>自测aaa</title>
<style type="text/css"></style>
<script>
	// Object
	function fun() {
		// 使用对象字面量，向函数传递不定量可选参数
		displayInfo({
			name : "bdceo",
			age : 24
		});
		displayInfo({
			name : "bdcoo"
		});
	}
	function displayInfo(args) {
		var output = "";
		if (typeof args.name == "string") {
			// 方括号，属性名访问
			output += "Name = " + args["name"] + "\n";
		}
		if (typeof args.age == "number") {
			output += "Age = " + args.age + "\n";
		}
		console.log(output);
	}
	// Array
	function fun2() {
		var arr = new Array(4);
		arr = new Array();
		arr = new Array("arr", 4, true);
		arr = [];
		arr = [ "arr", 4, true ];

		console.log(arr[0]);
		arr[2] = false;
		console.log(arr[2]);

		// length ,可读写
		console.log("length的可读写属性：");
		arr.length = 2;
		console.log(arr[2]);
		arr[arr.length] = false;
		arr[arr.length] = "ceo";
		console.log(arr[arr.length - 1]);

		// 格式化输出
		console.log("数组的转换");
		console.log("tostring = " + arr.toString());
		console.log("valueof = " + arr.valueOf());
		console.log("arr = " + arr);
		// 自定义输出：toLocalString
		var o1 = {
			toLocaleString : function() {
				return "BDCEO";
			},
			toString : function() {
				return "bdceo";
			}
		};
		var o2 = {
			toLocaleString : function() {
				return "BDCOO";
			},
			toString : function() {
				return "bdcoo";
			}
		};
		arr.length = 0;
		arr[arr.length] = o1;
		arr[arr.length] = o2;// 同push方法，在数组末尾追加
		console.log("toLocalString = " + arr.toLocaleString());
		console.log("arr = " + arr);
		console.log("join = " + arr.join(">>"));
		arr.length = 4;
		arr[arr.length - 1] = false;
		console.log("join = " + arr.join(">>"));

		// 栈：后进先出，push/pop;push = arr[arr.length]='';
		arr = [ "arr", 4, true ];
		var len = arr.push("bdceo", 24);
		console.log("push len = " + len);
		var item = arr.pop();
		console.log("pop = " + item);
		// 队列：先进先出，push/shift
		arr = [ "arr", 4, true ];
		len = arr.push("bdcoo", 25);
		console.log("push len = " + len);
		item = arr.shift();
		console.log("shift = " + item + "/" + arr.length);
		// 反队列：先进后出，unshift/pop
		arr = [ "arr", 4, true ];
		len = arr.unshift("fist");
		console.log("unshift len = " + len);
		item = arr.pop();
		console.log("item = " + item);

		// 排序：reverse/sort
		arr = [ 0, 1, 5, 10, 15 ];
		console.log("reverse = " + arr.reverse());
		console.log("sort = " + arr.sort());
		console.log("sort desc = " + arr.sort(compDesc));
		console.log("sort asc = " + arr.sort(compAsc));
		arr = [ "r", 4, true, "-1", false ];
		console.log("sort asc = " + arr.sort(compAsc));

		// 其他：concat-数据复制，连接；slice-数组项的截取；splice-删除插入替换
		arr = [ "red", "yellow", "green" ];
		arr = arr.concat("blue", [ "white", "black" ]);
		console.log("concat = " + arr);

		var a2 = arr.slice(2);
		console.log("slice = " + a2);
		a2 = arr.slice(3, 5);
		console.log("slice = " + a2);

		arr = [ 1, 1, 3, 5 ];
		a2 = arr.splice(1, 1);
		console.log("splice = " + arr);
		a2 = arr.splice(1, 0, 2);
		console.log("splice = " + arr);
		a2 = arr.splice(3, 1, 4, 5);
		console.log("splice = " + arr);
	}
	function compDesc(a, b) {
		if (a < b) {
			return 1;
		} else if (a > b) {
			return -1;
		} else {
			return 0;
		}
	}
	function compAsc(a, b) {
		if (a < b) {
			return -1;
		} else if (a > b) {
			return 1;
		} else {
			return 0;
		}
	}
	function compN(a, b) {
		return a - b;
	}
	// Date
	function fun3() {
		var d = new Date();
		console.log(d);
		d = new Date(Date.parse("2012/12/1 11:11:11"));
		console.log(d);
		d = new Date("2012/12/1 11:11:11");
		console.log(d);
		d = new Date(Date.UTC(2012, 4));
		console.log(d);
		d = new Date(Date.UTC(2012, 4, 11, 23, 22, 2));
		console.log(d);
		d = new Date(2012, 4, 11, 23, 22, 2);
		console.log(d);
		console.log(d.toString());
		console.log("toLocaleString = " + d.toLocaleString());
		console.log("valueOf(毫秒值) = " + d.valueOf());
		console.log("toDateString = " + d.toDateString());
		console.log("toTimeString = " + d.toTimeString());
		console.log("toLocalDateString = " + d.toLocaleDateString());
		console.log("toLocalTimeString = " + d.toLocaleTimeString());
		console.log("toUTCString = " + d.toUTCString());
		console.log("toGMTString = " + d.toGMTString());

		console.log("getTime(同valueof) = " + d.getTime());
		d = new Date();
		console.log("北京时间：" + d.getFullYear() + "年" + (d.getMonth() + 1) + "月"
				+ d.getDate() + "日(星期" + d.getDay() + ") " + d.getHours() + ":"
				+ d.getMinutes() + ":" + d.getSeconds() + "."
				+ d.getMilliseconds());
	}
	// RegExp
	function fun4() {
		var reg = /[bc]at/i;
		var regExp = new RegExp("[bc]at", "i");

		// exec:专为捕获组设计，返回匹配项信息的数组，返回项包含index和input两个属性
		var text = "mom and dad and baby";
		reg = /mom( and dad( and baby)?)?/gi;
		var matches = reg.exec(text);
		console.log("匹配项索引=" + matches.index);
		console.log("应用于=" + matches.input);
		console.log("匹配项=" + matches[0]);
		console.log("组1=" + matches[1]);
		console.log("组2=" + matches[2]);

		console.log("exec，应用捕获组全局设置属性");
		text = "cat, bat, sat, fat";
		reg = /.at/;
		matches = reg.exec(text);
		console.log(text);
		console.log(reg.toLocaleString());
		console.log("匹配项索引=" + matches.index);
		console.log("匹配项=" + matches[0]);
		console.log("下一个索引=" + reg.lastIndex);
		matches = reg.exec(text);
		console.log("匹配项索引=" + matches.index);
		console.log("匹配项=" + matches[0]);
		console.log("下一个索引=" + reg.lastIndex);

		reg = /.bt/g;
		console.log(reg.toString());
		var li = 0;
		var len = text.length;
		do {
			matches = reg.exec(text);
			if (matches === null) {
				break;
			}
			li = reg.lastIndex;
			console.log("匹配项索引=" + matches.index);
			console.log("匹配项=" + matches[0]);
			console.log("下一个索引=" + li);
		} while (li > 0 && li < len);

		matches = text.match(reg);
		console.log("String.match = " + matches);

		text = "000-00-0000";
		reg = /\d{3}-\d{2}-\d{4}/;
		console.log("test = " + reg.test(text));
	}
	// Function
	function fun5() {
		var r = sum2(1, 2);
		console.log(r);

		r = callSomeFunction(add10, 11);
		console.log(r);
		r = callSomeFunction(getGreeting, "bdce0");
		console.log(r);

		var data = [ {
			name : "Zach",
			age : 15
		}, {
			name : "Nicho",
			age : 19
		} ];
		data.sort(createCompFun("name"));
		console.log(data[0].name);
		data.sort(createCompFun("age"));
		console.log(data[0].name);

		var trueFactorial = factorial;
		factorial = function() {
			return -1;
		};
		console.log(trueFactorial(5));
		console.log(factorial(5));

		o.showCol = showCol;
		o.showCol();

		// 函数的属性和方法
		console.log(showCol.length);
		console.log(sum2.length);

		// 调用栈
		console.log(arguments.callee.caller);
		showCol.call(this);
		showCol.call(obj);
	}
	// 函数没有重载
	function sum(a, b) {
		return a + b;
	}
	var sum = function(a, b) {
		return a + b;
	};
	var sum = new Function("a", "b", "return a+b");
	var sum2 = sum;
	sum = null;// 函数名是指向函数对象的指针
	// 作为值的函数
	function callSomeFunction(fun, arg) {
		return fun(arg);
	}
	function add10(num) {
		return num + 10;
	}
	function getGreeting(name) {
		return "Hello, " + name;
	}
	// 从一个函数返回另一个函数
	function createCompFun(proName) {
		// 通过变量来访问属性
		return function(oa, ob) {
			var va = oa[proName];// 不同于oa.proName，也不能这样使用在这里
			var vb = ob[proName];
			if (va < vb) {
				return -1;
			} else if (va > vb) {
				return 1;
			} else {
				return 0;
			}
		}
	}
	// 函数的内部属性：callee/this
	function factorial(num) {
		if (num <= 1) {
			return;
		}
		return num * factorial(num - 1);
	}
	function factorial(num) {
		if (num <= 1) {
			return 1;
		}
		return num * arguments.callee(num - 1);
	}
	window.color = "red";
	var o = {
		color : "blue"
	};
	var obj = {
		color : "black"
	};
	function showCol() {
		console.log("颜色：" + this.color);
	}
	showCol();
	// 函数的方法
	function add(a, b) {
		return a + b;
	}
	//call/apply: 实现类似继承一样的功能
	//call, apply作用就是借用别人的方法来调用,就像调用自己的一样
	// 参考：http://www.cnblogs.com/fighting_cp/archive/2010/09/20/1831844.html
	function callAdd1(a, b) {
		return add.apply(this, arguments);
	}
	function callAdd2(a, b) {
		return add.apply(this, arguments);
	}
	function callAdd3(a, b) {
		return add.call(this, a, b); 
	}
	console.log("callAdd1 = " + callAdd1(1, 2));
	console.log("callAdd2 = " + callAdd2(2, 3));
	console.log("callAdd3 = " + callAdd3(3, 4));
	
	// 关于this，参考：http://www.cnblogs.com/ruxpinsp1/archive/2008/04/20/1162463.html
</script>
</head>
<body onload="fun5();">
</body>
</html>